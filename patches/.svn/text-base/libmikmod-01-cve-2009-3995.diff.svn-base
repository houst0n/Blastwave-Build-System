--- libmikmod-3.2.0-beta2/loaders/load_it.c	Fri Feb  6 20:29:03 2004
+++ libmikmod-3.2.0-beta2-patch/loaders/load_it.c	Mon Jul 19 14:48:34 2010
@@ -862,6 +862,10 @@
 #endif
 
 				IT_ProcessEnvelope(vol);
+				/* fix for CVE-2009-3995 */
+				if (ih.volpts>= ENVPOINTS)
+					ih.volpts = ENVPOINTS-1;
+
 				for(u=0;u<ih.volpts;u++)
 					d->volenv[u].val=(ih.volnode[u]<<2);
 
